<html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script> 
<script src="joy.js"></script>
<style type="text/css">
    body {
        margin: 0;
        overflow: hidden;
        user-select: none;
    }
    canvas {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        outline: none;
        -webkit-tap-highlight-color: rgba(255, 255, 255, 0); /* mobile webkit */
    
</style>
<script>
    var joystick;
    var playerName = "";
    function sendMove(dir) {
        console.log("Move : " + dir);
        // this is how you call a url
        $.get("/action?command=move&direction=" + dir + "&name=" + playerName);
    }
    function registerPlayer() {
        $("#registration").hide();
        $("#gamePanel").show();
        var name = $("#playerName").val();
        playerName = encodeURIComponent(name);
        $.get("/action?command=join&name=" + playerName);

    //    $("#registration").hide();
      //  displayCanvas();
    }
    function sendJoin(name) {

    }
    function init() {
        $("#gamePanel").hide();
        joystick = new JoyStick("joystick", {
            height: 200,
            width: 200
        });
        setInterval(checkJoystick,30);

        
    }
    function checkJoystick() {
        console.log(joystick.GetX());
        if (joystick.GetX() == 0) {
            sendMove("stop");
        }
        else {
            if (Math.abs(joystick.GetX()) > Math.abs(joystick.GetY())) {
                if (joystick.GetX() < 0) {
                    sendMove("left");
                }
                if (joystick.GetX() > 0) {
                    sendMove("right");
                }
            }
            else {
                if (joystick.GetY() < 0) {
                    sendMove("down");
                }
                if (joystick.GetY() > 0) {
                    sendMove("up");
                }
            }
        }
        
        
    }
    var canvas;
    var ctx;

  

    function stopMovement() {
        sendMove('stop');
    }


</script>
<body style="background-color:#a39161" " onload="init()">

    <div id="gamePanel">
        <table width="100%">
            <tr>
                <td>
                    <div id="joystick">

                    </div>
                </td>
                <td>
                    <canvas id="myCanvas">

                    </canvas>
                </td>
                <td>
                    ATTACK!!!!!
                </td>
            </tr>
        </table>
        
    </div>


    <div id="registration">
        
        <br />
        <input id="playerName" />

        <button onclick="registerPlayer()">Join!!!!!!!!!</button>
    </div>
</body>


</html>